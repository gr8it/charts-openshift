# Namespace configuration
sourceNamespace: apc-backup
targetNamespace: openshift-adp

# Kyverno policy toggle
kyverno:
  enabled: true
  injectCa: true

# Credential transformation
credentials:
  backup:
    sourceName: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-backup'
    targetName: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-backup-cloud-credentials'
  restore:
    sourceName: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-restore'
    targetName: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-restore-cloud-credentials'

# DataProtectionApplication configuration
dpa:
  name: apc-dpa
  backupLocations:
    - name: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-backup'
      bucket: ''
      prefix: 'backup/{{ include "apc-global-overrides.environment" . }}-app'
      default: true
    - name: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-restore'
      bucket: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-restore-92a26d80-8740-42b6-88d8-f4ce195d6368'
      prefix: 'backup/{{ include "apc-global-overrides.environment" . }}-app'
      default: false

  # S3 configuration
  s3:
    region: us-east-1
    url: https://rook-ceph-rgw-ocs-storagecluster-cephobjectstore.openshift-storage.svc:443
    forcePathStyle: "true"
    insecureSkipTLSVerify: "false"
    caCert: 
  
  # Velero configuration  
  velero:
    defaultPlugins:
      - openshift
      - aws
      - kubevirt
      - csi
    defaultSnapshotMoveData: true
    defaultVolumesToFSBackup: false
    resourceTimeout: 60m
  
  # NodeAgent (formerly restic) configuration
  nodeAgent:
    enabled: true
    uploaderType: kopia
    resourceAllocations:
      limits:
        cpu: "2"
        memory: 32Gi
      requests:
        cpu: 500m
        memory: 4Gi

# ServiceMonitor for monitoring
serviceMonitor:
  enabled: true
  namespace: openshift-adp

# ObjectBucketClaim for backup storage
objectBucketClaims:
  enabled: true
  backup:
    name: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-backup'
    storageClassName: ocs-storagecluster-ceph-rgw
  restore:
    name: 'oadp-{{ include "apc-global-overrides.environment" . }}-app-restore'
    storageClassName: ocs-storagecluster-ceph-rgw

# Standard APC labels will be applied via apc-global-overrides
