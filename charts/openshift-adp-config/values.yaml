environment: {{ include "apc-global-overrides.environment" . }}

# Namespace configuration
sourceNamespace: apc-backup
targetNamespace: openshift-adp

# Kyverno policy toggle
kyverno:
  enabled: true

# Credential transformation
credentials:
  backup:
    sourceName: {{ printf "oadp-%s-app-backup" (include "apc-global-overrides.environment" .) }}
    targetName: {{ printf "oadp-%s-app-backup-cloud-credentials" (include "apc-global-overrides.environment" .) }}
  restore:
    sourceName: {{ printf "oadp-%s-app-restore" (include "apc-global-overrides.environment" .) }}
    targetName: {{ printf "oadp-%s-app-restore-cloud-credentials" (include "apc-global-overrides.environment" .) }}

# DataProtectionApplication configuration
dpa:
  name: apc-dpa
  backupLocations:
    - name: {{ printf "oadp-%s-app-backup" (include "apc-global-overrides.environment" .) }}
      bucket: ""
      prefix: {{ printf "backup/%s-app" (include "apc-global-overrides.environment" .) }}
      default: true
    - name: {{ printf "oadp-%s-app-restore" (include "apc-global-overrides.environment" .) }}
      bucket: {{ printf "oadp-%s-app-restore-92a26d80-8740-42b6-88d8-f4ce195d6368" (include "apc-global-overrides.environment" .) }}
      prefix: {{ printf "backup/%s-app" (include "apc-global-overrides.environment" .) }}
      default: false

  # S3 configuration
  s3:
    region: us-east-1
    url: https://rook-ceph-rgw-ocs-storagecluster-cephobjectstore.openshift-storage.svc:443
    forcePathStyle: "true"
    insecureSkipTLSVerify: "false"
    caCert: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURVVENDQWptZ0F3SUJBZ0lJUVFxdWZjdGx1V1V3RFFZSktvWklodmNOQVFFTEJRQXdOakUwTURJR0ExVUUKQXd3cmIzQmxibk5vYVdaMExYTmxjblpwWTJVdGMyVnlkbWx1WnkxemFXZHVaWEpBTVRjek5qVXhOemd4TXpBZQpGdzB5TlRBeE1UQXhOREF6TXpKYUZ3MHlOekF6TVRFeE5EQXpNek5hTURZeE5EQXlCZ05WQkFNTUsyOXdaVzV6CmFHbG1kQzF6WlhKMmFXTmxMWE5sY25acGJtY3RjMmxuYm1WeVFERTNNelkxTVRjNE1UTXdnZ0VpTUEwR0NTcUcKU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQzVaemZneWx4TlRQemZuVzNRbXQzVGdPRnBPbFBtMmxnOApkM21zT3pkOFBYT25oZW16TEExa3RSZ1cwdGFOWEs4YURBbDZxMExNQ2Fpa2Q2SmlEcm9iQVZnTDgwcng5S3drCmdoL3lTSHp3a2dWTkRORFg0cmlVWE8zWmZwLzRDeFdGQ3pXUHlRblJsQTlKSlQzeVE2bGp5WHR2RlkvYjJEZ2oKNlRlOFlqcG5xOGd0cldWTzU4dkEzd0RHZG1WamQ5YzZYc0txMWo2dzduNmVKVCtWUGZtNW51TWdyT0FJN2hDYQp5blhPZlFWZndORk9lU0tOblZPbWlieTBaVmRqZ3FIQU0xT3FwalBIa2VDOGZuU2VrbkJwV0hxVGpaMkh0UkhzCmlhVXdUbFkxZitrVnd3Z1QxMENrMERFZmxlamcySTZQMU9GelJiRWw5WXdOQWc5b1k5RHZBZ01CQUFHall6QmgKTUE0R0ExVWREd0VCL3dRRUF3SUNwREFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQjBHQTFVZERnUVdCQlNOZndSegpFSVBwbWdlcW1KNHFHT3RFYkFWNGdEQWZCZ05WSFNNRUdEQVdnQlNOZndSekVJUHBtZ2VxbUo0cUdPdEViQVY0CmdEQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFwN1V1a0VKYkY2SFZDR0ZuY3FJSFhOdkVIcWxZWUhlZVcrR1YKT1JlenlJS1o1WjBVKzlyeFFLWXZFT0dVZGR2OTlsZVBsS3ljWTUyRHFZblVxbmhYL0ZXamg5RVZ0V1RPaWo4YwpRb1ROWjJlTmZiWkJRUUg3ZmR5SnA2ZC83ankyd3dRRGhHL1FoT0cxd0QzNEMydk90L2VxOS9wN2VJaU12OUNnCjlCVXRBNTRmWFN5Q0REZjVBcDJwRUlNOHM2eUNzR1RuMHpxSVVrUTQ0Vlc1OUpiSlMwTEJDejlXZ3RGSC9WM24KTVNNZjVqQ3RuczE1bVo4aEFJN1RrbThNMEl4ZDdvZUpEU0hYNVY0eDhHWkJjdDlOR0d2SGlheUt3aDBZbWphMQpqT0t2dzFwM0VkNUdKckljU3hFbjUxZldhSjJpdi8zM2hVSzVYaGV1bCtGa2JGYXRlZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  
  # Velero configuration  
  velero:
    defaultPlugins:
      - openshift
      - aws
      - kubevirt
      - csi
    defaultSnapshotMoveData: true
    defaultVolumesToFSBackup: false
    resourceTimeout: 60m
  
  # NodeAgent (formerly restic) configuration
  nodeAgent:
    enabled: true
    uploaderType: kopia
    resourceAllocations:
      limits:
        cpu: "2"
        memory: 32Gi
      requests:
        cpu: 500m
        memory: 4Gi

# ServiceMonitor for monitoring
serviceMonitor:
  enabled: true
  namespace: openshift-adp

# ObjectBucketClaim for backup storage
objectBucketClaims:
  enabled: true
  backup:
    name: {{ printf "oadp-%s-app-backup" (include "apc-global-overrides.environment" .) }}
    storageClassName: ocs-storagecluster-ceph-rgw
  restore:
    name: {{ printf "oadp-%s-app-restore" (include "apc-global-overrides.environment" .) }}
    storageClassName: ocs-storagecluster-ceph-rgw

# Standard APC labels will be applied via apc-global-overrides
