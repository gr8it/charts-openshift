acm-operatorpolicy:
  subscription:
    channel: stable
    name: compliance-operator-sub
    namespace: openshift-compliance
    source: redhat-operators
    sourceNamespace: openshift-marketplace
    config:
      nodeSelector:
        node-role.kubernetes.io/worker: ""
      env:
      - name: PLATFORM
        value: "HyperShift"

  operatorGroup:
    name: compliance-operator
    namespace: openshift-compliance
    targetNamespaces:
    - openshift-compliance

  upgradeApproval: Manual
  versions:
    - compliance-operator.v1.6.0

# Namespace configuration
namespace:
  name: openshift-compliance
  labels:
    openshift.io/cluster-monitoring: "true"
    pod-security.kubernetes.io/enforce: privileged

# ScanSetting configuration
scanSetting:
  name: cis-scan-settings
  rawResultStorage:
    nodeSelector:
      node-role.kubernetes.io/worker: ""
    pvAccessModes:
      - ReadWriteOnce
    rotation: 3
    size: 1Gi
    tolerations:
      - operator: Exists
  roles:
    - worker
  scanTolerations:
    - operator: Exists
  schedule: "0 1 * * *"
  showNotApplicable: false
  strictNodeScan: true
  suspend: false
  timeout: 30m0s

# ScanSettingBinding configuration
scanSettingBinding:
  name: cis-compliance
  profiles:
    - name: ocp4-cis-node
      kind: Profile
      apiGroup: compliance.openshift.io/v1alpha1
  settingsRef:
    name: cis-scan-settings
    kind: ScanSetting
    apiGroup: compliance.openshift.io/v1alpha1
