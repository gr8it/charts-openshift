apiVersion: kubernetes.vault.upbound.io/v1alpha1
kind: AuthBackendRole
metadata:
  name: {{ include "apc-global-overrides.clusterName" . }}-{{ .Values.vaultKubeAuthRole }}
spec:
  forProvider:
    audience: vault://{{ include "apc-global-overrides.require-certManagerDefaultClusterIssuer" . }}
    backend: {{ include "apc-global-overrides.require-vaultKubeAuthMountPath" . }}
    boundServiceAccountNames:
      - {{ .Values.kubeServiceAccount }}
    boundServiceAccountNamespaces:
      - {{ .Release.Namespace }}
    roleName: {{ .Values.vaultKubeAuthRole }}
    tokenPolicies:
      - default
      - {{ include "apc-global-overrides.clusterName" . }}--{{ .Values.vaultKubeAuthRole }}
    tokenTtl: 900
  providerConfigRef:
    name: {{ include "apc-global-overrides.require-crossplaneKubeVaultProviderConfigName" . }}
